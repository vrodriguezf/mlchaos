{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:30.815986Z",
     "iopub.status.busy": "2020-10-13T16:59:30.815429Z",
     "iopub.status.idle": "2020-10-13T16:59:30.824979Z",
     "shell.execute_reply": "2020-10-13T16:59:30.825432Z"
    },
    "papermill": {
     "duration": 0.061743,
     "end_time": "2020-10-13T16:59:30.825584",
     "exception": false,
     "start_time": "2020-10-13T16:59:30.763841",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# hide\n",
    "import sys\n",
    "sys.path.append(\"..\")\n",
    "%load_ext autoreload\n",
    "%autoreload 2"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.035109,
     "end_time": "2020-10-13T16:59:30.897667",
     "exception": false,
     "start_time": "2020-10-13T16:59:30.862558",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Motion classification with time series using deep learning\n",
    "\n",
    "> Classify between chaotic, rotational and librational motion using the evolution of the coordinates x and y in the Poincare map"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.03503,
     "end_time": "2020-10-13T16:59:30.967744",
     "exception": false,
     "start_time": "2020-10-13T16:59:30.932714",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Requirements"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:31.044085Z",
     "iopub.status.busy": "2020-10-13T16:59:31.043579Z",
     "iopub.status.idle": "2020-10-13T16:59:31.054021Z",
     "shell.execute_reply": "2020-10-13T16:59:31.053327Z"
    },
    "papermill": {
     "duration": 0.051353,
     "end_time": "2020-10-13T16:59:31.054202",
     "exception": false,
     "start_time": "2020-10-13T16:59:31.002849",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import sys\n",
    "ISCOLAB = 'google.colab' in sys.modules\n",
    "if ISCOLAB:\n",
    "    !pip install git+https://github.com/fastai/fastcore.git@master -q\n",
    "    !pip install git+https://github.com/fastai/fastai2.git@master -q\n",
    "    !pip install git+https://github.com/ai-fast-track/timeseries.git -q\n",
    "    !pip install wandb -q"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:31.134712Z",
     "iopub.status.busy": "2020-10-13T16:59:31.134183Z",
     "iopub.status.idle": "2020-10-13T16:59:32.845079Z",
     "shell.execute_reply": "2020-10-13T16:59:32.845512Z"
    },
    "papermill": {
     "duration": 1.750503,
     "end_time": "2020-10-13T16:59:32.845645",
     "exception": false,
     "start_time": "2020-10-13T16:59:31.095142",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from fastai.basics import *\n",
    "from timeseries.all import *\n",
    "from mlchaos.all import *\n",
    "import wandb\n",
    "from fastai.callback.wandb import *"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:32.921094Z",
     "iopub.status.busy": "2020-10-13T16:59:32.920483Z",
     "iopub.status.idle": "2020-10-13T16:59:32.943840Z",
     "shell.execute_reply": "2020-10-13T16:59:32.943304Z"
    },
    "papermill": {
     "duration": 0.061976,
     "end_time": "2020-10-13T16:59:32.943950",
     "exception": false,
     "start_time": "2020-10-13T16:59:32.881974",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "base_path = Path.home()\n",
    "ds_path = base_path/'data/fli_rotnum/model_1'"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.035639,
     "end_time": "2020-10-13T16:59:33.016612",
     "exception": false,
     "start_time": "2020-10-13T16:59:32.980973",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Notebook parameters \n",
    "Put here everything that could be needed if this notebook was called from outside, as an script"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:33.091614Z",
     "iopub.status.busy": "2020-10-13T16:59:33.091095Z",
     "iopub.status.idle": "2020-10-13T16:59:33.114846Z",
     "shell.execute_reply": "2020-10-13T16:59:33.114293Z"
    },
    "papermill": {
     "duration": 0.062696,
     "end_time": "2020-10-13T16:59:33.114957",
     "exception": false,
     "start_time": "2020-10-13T16:59:33.052261",
     "status": "completed"
    },
    "tags": [
     "parameters"
    ]
   },
   "outputs": [],
   "source": [
    "use_wandb = True # Whether to use or not wandb for experiment tracking\n",
    "wandb_group = 'None' # Whether to group this run in a wandb group\n",
    "resampling_period = None # * Natural number. Set to None if no resampling is desired\n",
    "labelling_method = \"fli\" # [fli, freq_ana, birkhoff_avg]\n",
    "fnames = [\n",
    "    (ds_path/'eps=0.021/Poincare.plt', ds_path/'eps=0.021/index_fli_rotnum_birav.plt'),\n",
    "    (ds_path/'eps=0.022/Poincare.plt', ds_path/'eps=0.022/index_fli_rotnum_birav.plt'), \n",
    "    (ds_path/'eps=0.023/Poincare.plt', ds_path/'eps=0.023/index_fli_rotnum_birav.plt'), \n",
    "    (ds_path/'eps=0.024/Poincare.plt', ds_path/'eps=0.024/index_fli_rotnum_birav.plt'), \n",
    "    (ds_path/'eps=0.025/Poincare.plt', ds_path/'eps=0.025/index_fli_rotnum_birav.plt'), \n",
    "]\n",
    "val_dataset = 'eps=0.023' # * The rest of the datasets in fnames will be used for training"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:33.191732Z",
     "iopub.status.busy": "2020-10-13T16:59:33.191193Z",
     "iopub.status.idle": "2020-10-13T16:59:33.214466Z",
     "shell.execute_reply": "2020-10-13T16:59:33.214922Z"
    },
    "papermill": {
     "duration": 0.062587,
     "end_time": "2020-10-13T16:59:33.215052",
     "exception": false,
     "start_time": "2020-10-13T16:59:33.152465",
     "status": "completed"
    },
    "tags": [
     "injected-parameters"
    ]
   },
   "outputs": [],
   "source": [
    "# Parameters\n",
    "use_wandb = True\n",
    "wandb_group = \"x_labelling_method\"\n",
    "labelling_method = \"fli\"\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.035984,
     "end_time": "2020-10-13T16:59:33.287520",
     "exception": false,
     "start_time": "2020-10-13T16:59:33.251536",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Syncing with Weights & Biases\n",
    "\n",
    "For large experiments, when this notebooks is called from outside with different parameters, it is important to use wandb to track the results and config of this notebook and to track and aggregate the results online afterwards."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:33.363147Z",
     "iopub.status.busy": "2020-10-13T16:59:33.362630Z",
     "iopub.status.idle": "2020-10-13T16:59:34.959891Z",
     "shell.execute_reply": "2020-10-13T16:59:34.959283Z"
    },
    "papermill": {
     "duration": 1.636207,
     "end_time": "2020-10-13T16:59:34.960051",
     "exception": false,
     "start_time": "2020-10-13T16:59:33.323844",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Failed to query for notebook name, you can set it manually with the WANDB_NOTEBOOK_NAME environment variable\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: Currently logged in as: \u001b[33mvrodriguezf\u001b[0m (use `wandb login --relogin` to force relogin)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: wandb version 0.10.5 is available!  To upgrade, please run:\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  $ pip install wandb --upgrade\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "\n",
       "                Tracking run with wandb version 0.10.4<br/>\n",
       "                Syncing run <strong style=\"color:#cdcd00\">royal-dragon-182</strong> to <a href=\"https://wandb.ai\" target=\"_blank\">Weights & Biases</a> <a href=\"https://docs.wandb.com/integrations/jupyter.html\" target=\"_blank\">(Documentation)</a>.<br/>\n",
       "                Project page: <a href=\"https://wandb.ai/vrodriguezf/mlchaos\" target=\"_blank\">https://wandb.ai/vrodriguezf/mlchaos</a><br/>\n",
       "                Run page: <a href=\"https://wandb.ai/vrodriguezf/mlchaos/runs/1nm0z5un\" target=\"_blank\">https://wandb.ai/vrodriguezf/mlchaos/runs/1nm0z5un</a><br/>\n",
       "                Run data is saved locally in <code>wandb/run-20201013_165933-1nm0z5un</code><br/><br/>\n",
       "            "
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "if not use_wandb:\n",
    "    os.environ['WANDB_MODE'] = 'dryrun' # run offline\n",
    "    wandb.init(anonymous='allow', allow_val_change=True)\n",
    "else:\n",
    "    os.environ['WANDB_MODE'] = 'run'\n",
    "    wandb.init(entity=\"vrodriguezf\", project='mlchaos', group=wandb_group)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.036911,
     "end_time": "2020-10-13T16:59:35.035935",
     "exception": false,
     "start_time": "2020-10-13T16:59:34.999024",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Loading the data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.036731,
     "end_time": "2020-10-13T16:59:35.109834",
     "exception": false,
     "start_time": "2020-10-13T16:59:35.073103",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "The data must be loaded as a `TSDataChaos` object, created from a pair (or a sequence of pairs) of files:\n",
    "1. The first file of the pair contains the data of the Poincare map\n",
    "2. The second file of the pair contains the index of the motion (0.0, 1.0 or 2.0). The column that contains the index is given as a parameter of this notebook\n",
    "\n",
    "Depending on the labelling method, a different column from the index file will be used as `y` on the data. `x` will always be the time series."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:35.193452Z",
     "iopub.status.busy": "2020-10-13T16:59:35.192772Z",
     "iopub.status.idle": "2020-10-13T16:59:35.222176Z",
     "shell.execute_reply": "2020-10-13T16:59:35.221661Z"
    },
    "papermill": {
     "duration": 0.075265,
     "end_time": "2020-10-13T16:59:35.222301",
     "exception": false,
     "start_time": "2020-10-13T16:59:35.147036",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "wandb.config.labelling_method = labelling_method\n",
    "index_cols = {\n",
    "    \"fli\": 4,\n",
    "    \"freq_ana\": 5,\n",
    "    \"birkhoff_avg\": 6\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:35.301038Z",
     "iopub.status.busy": "2020-10-13T16:59:35.300528Z",
     "iopub.status.idle": "2020-10-13T16:59:45.084023Z",
     "shell.execute_reply": "2020-10-13T16:59:45.084463Z"
    },
    "papermill": {
     "duration": 9.823846,
     "end_time": "2020-10-13T16:59:45.084594",
     "exception": false,
     "start_time": "2020-10-13T16:59:35.260748",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "TSDataChaos:\n",
       " Datasets names (concatenated): ['eps=0.021', 'eps=0.022', 'eps=0.023', 'eps=0.024', 'eps=0.025']\n",
       " Filenames:                     [(Path('/home/user/data/fli_rotnum/model_1/eps=0.021/Poincare.plt'), Path('/home/user/data/fli_rotnum/model_1/eps=0.021/index_fli_rotnum_birav.plt')), (Path('/home/user/data/fli_rotnum/model_1/eps=0.022/Poincare.plt'), Path('/home/user/data/fli_rotnum/model_1/eps=0.022/index_fli_rotnum_birav.plt')), (Path('/home/user/data/fli_rotnum/model_1/eps=0.023/Poincare.plt'), Path('/home/user/data/fli_rotnum/model_1/eps=0.023/index_fli_rotnum_birav.plt')), (Path('/home/user/data/fli_rotnum/model_1/eps=0.024/Poincare.plt'), Path('/home/user/data/fli_rotnum/model_1/eps=0.024/index_fli_rotnum_birav.plt')), (Path('/home/user/data/fli_rotnum/model_1/eps=0.025/Poincare.plt'), Path('/home/user/data/fli_rotnum/model_1/eps=0.025/index_fli_rotnum_birav.plt'))]\n",
       " Data shape: (51005, 2, 201)\n",
       " Targets shape: (51005,)\n",
       " Nb Samples: 51005\n",
       " Nb Channels:           2\n",
       " Sequence Length: 201"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "wandb.config.fnames = fnames\n",
    "data = TSDataChaos.from_poincare_and_index_files(fnames, \n",
    "                                                 index_col=index_cols[labelling_method])\n",
    "data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.037784,
     "end_time": "2020-10-13T16:59:45.160557",
     "exception": false,
     "start_time": "2020-10-13T16:59:45.122773",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Check the distribution of classes in the dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:45.240922Z",
     "iopub.status.busy": "2020-10-13T16:59:45.240424Z",
     "iopub.status.idle": "2020-10-13T16:59:45.268774Z",
     "shell.execute_reply": "2020-10-13T16:59:45.268315Z"
    },
    "papermill": {
     "duration": 0.068721,
     "end_time": "2020-10-13T16:59:45.268890",
     "exception": false,
     "start_time": "2020-10-13T16:59:45.200169",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(array([-1.,  0.,  1.,  2.]), array([ 3990,  3800, 25444, 17771]))"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.unique(data.y, return_counts=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.03789,
     "end_time": "2020-10-13T16:59:45.345586",
     "exception": false,
     "start_time": "2020-10-13T16:59:45.307696",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "The class -1 represents uncertainty in the FLI-based classication. If desired, we can remove that class from the dataset, by changing the flag `add_uncertainty_class` in the cell below. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:45.424667Z",
     "iopub.status.busy": "2020-10-13T16:59:45.424144Z",
     "iopub.status.idle": "2020-10-13T16:59:45.451197Z",
     "shell.execute_reply": "2020-10-13T16:59:45.450735Z"
    },
    "papermill": {
     "duration": 0.067978,
     "end_time": "2020-10-13T16:59:45.451314",
     "exception": false,
     "start_time": "2020-10-13T16:59:45.383336",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "wandb.config.add_uncertainty_class = False"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:45.532359Z",
     "iopub.status.busy": "2020-10-13T16:59:45.531830Z",
     "iopub.status.idle": "2020-10-13T16:59:45.612231Z",
     "shell.execute_reply": "2020-10-13T16:59:45.611776Z"
    },
    "papermill": {
     "duration": 0.121761,
     "end_time": "2020-10-13T16:59:45.612347",
     "exception": false,
     "start_time": "2020-10-13T16:59:45.490586",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "TSDataChaos:\n",
       " Datasets names (concatenated): ['eps=0.021', 'eps=0.022', 'eps=0.023', 'eps=0.024', 'eps=0.025']\n",
       " Filenames:                     [(Path('/home/user/data/fli_rotnum/model_1/eps=0.021/Poincare.plt'), Path('/home/user/data/fli_rotnum/model_1/eps=0.021/index_fli_rotnum_birav.plt')), (Path('/home/user/data/fli_rotnum/model_1/eps=0.022/Poincare.plt'), Path('/home/user/data/fli_rotnum/model_1/eps=0.022/index_fli_rotnum_birav.plt')), (Path('/home/user/data/fli_rotnum/model_1/eps=0.023/Poincare.plt'), Path('/home/user/data/fli_rotnum/model_1/eps=0.023/index_fli_rotnum_birav.plt')), (Path('/home/user/data/fli_rotnum/model_1/eps=0.024/Poincare.plt'), Path('/home/user/data/fli_rotnum/model_1/eps=0.024/index_fli_rotnum_birav.plt')), (Path('/home/user/data/fli_rotnum/model_1/eps=0.025/Poincare.plt'), Path('/home/user/data/fli_rotnum/model_1/eps=0.025/index_fli_rotnum_birav.plt'))]\n",
       " Data shape: (47015, 2, 201)\n",
       " Targets shape: (47015,)\n",
       " Nb Samples: 47015\n",
       " Nb Channels:           2\n",
       " Sequence Length: 201"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# TODO: Move this to a function\n",
    "if not wandb.config.add_uncertainty_class:\n",
    "    data.x = data.x[data.y != -1]\n",
    "    data.ds = data.ds[data.y != -1]\n",
    "    data.y = data.y[data.y != -1]\n",
    "data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.038998,
     "end_time": "2020-10-13T16:59:45.691146",
     "exception": false,
     "start_time": "2020-10-13T16:59:45.652148",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "The data can be resampled to a lower frequency if desired. The reason why this is interesting is because being able to produce an accurate classification without the need of many data points per time series makes this procedure applicable to observational data. As an example, choosing `resampling_period` equals to 2 means that the time series will be resampled in a way that we take one point every 2 points of the original data.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:45.771455Z",
     "iopub.status.busy": "2020-10-13T16:59:45.770959Z",
     "iopub.status.idle": "2020-10-13T16:59:45.797204Z",
     "shell.execute_reply": "2020-10-13T16:59:45.796761Z"
    },
    "papermill": {
     "duration": 0.067459,
     "end_time": "2020-10-13T16:59:45.797322",
     "exception": false,
     "start_time": "2020-10-13T16:59:45.729863",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "wandb.config.resampling_period = resampling_period"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:45.881124Z",
     "iopub.status.busy": "2020-10-13T16:59:45.880613Z",
     "iopub.status.idle": "2020-10-13T16:59:45.908449Z",
     "shell.execute_reply": "2020-10-13T16:59:45.907036Z"
    },
    "papermill": {
     "duration": 0.069819,
     "end_time": "2020-10-13T16:59:45.908570",
     "exception": false,
     "start_time": "2020-10-13T16:59:45.838751",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "if wandb.config.resampling_period is not None:\n",
    "    data.x = data.x[:,:,::wandb.config.resampling_period]\n",
    "    print(data)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.038495,
     "end_time": "2020-10-13T16:59:45.986883",
     "exception": false,
     "start_time": "2020-10-13T16:59:45.948388",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "We'll use a dictionary to establish how to label each index to an actual human-readable label"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:46.067281Z",
     "iopub.status.busy": "2020-10-13T16:59:46.066739Z",
     "iopub.status.idle": "2020-10-13T16:59:46.092308Z",
     "shell.execute_reply": "2020-10-13T16:59:46.092754Z"
    },
    "papermill": {
     "duration": 0.067792,
     "end_time": "2020-10-13T16:59:46.092892",
     "exception": false,
     "start_time": "2020-10-13T16:59:46.025100",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "lbl_dict = dict([\n",
    "    ('-1.0', 'uncertain'),\n",
    "    ('0.0', 'chaotic'),   \n",
    "    ('1.0', 'rotational'),   \n",
    "    ('2.0', 'librational')]\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.038922,
     "end_time": "2020-10-13T16:59:46.172065",
     "exception": false,
     "start_time": "2020-10-13T16:59:46.133143",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Splitting the data into training and validation"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.038788,
     "end_time": "2020-10-13T16:59:46.250065",
     "exception": false,
     "start_time": "2020-10-13T16:59:46.211277",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "One easy option to split data is to use 80% random items from the data as training and 20% as validation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:46.330681Z",
     "iopub.status.busy": "2020-10-13T16:59:46.330145Z",
     "iopub.status.idle": "2020-10-13T16:59:46.514177Z",
     "shell.execute_reply": "2020-10-13T16:59:46.513693Z"
    },
    "papermill": {
     "duration": 0.225554,
     "end_time": "2020-10-13T16:59:46.514294",
     "exception": false,
     "start_time": "2020-10-13T16:59:46.288740",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "splits = RandomSplitter()(range_of(data.get_items()))\n",
    "#splits = (range_of(data.get_items()), range_of(data.get_items())) # Valid = train"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.038984,
     "end_time": "2020-10-13T16:59:46.592867",
     "exception": false,
     "start_time": "2020-10-13T16:59:46.553883",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Another way to split the data, which is more sensible if we want to ensure that the knowledge in the model can be transferred to unknown dynamic models, is to ensure that motions in the validation set are not included in the training set. We can do this by ensuring that the motions of the validation set belong to a specific dynamic model, and the rest of dynamics will be used for training"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:46.703663Z",
     "iopub.status.busy": "2020-10-13T16:59:46.703149Z",
     "iopub.status.idle": "2020-10-13T16:59:46.728648Z",
     "shell.execute_reply": "2020-10-13T16:59:46.728109Z"
    },
    "papermill": {
     "duration": 0.097163,
     "end_time": "2020-10-13T16:59:46.728766",
     "exception": false,
     "start_time": "2020-10-13T16:59:46.631603",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "wandb.config.val_ds = val_dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:46.811572Z",
     "iopub.status.busy": "2020-10-13T16:59:46.811077Z",
     "iopub.status.idle": "2020-10-13T16:59:46.837896Z",
     "shell.execute_reply": "2020-10-13T16:59:46.837368Z"
    },
    "papermill": {
     "duration": 0.06848,
     "end_time": "2020-10-13T16:59:46.838013",
     "exception": false,
     "start_time": "2020-10-13T16:59:46.769533",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([18990, 18991, 18992, ..., 28288, 28289, 28290])"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "val_idxs = np.where(data.ds == data.dsname.index(val_dataset))[0]\n",
    "val_idxs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:46.921333Z",
     "iopub.status.busy": "2020-10-13T16:59:46.920806Z",
     "iopub.status.idle": "2020-10-13T16:59:46.987037Z",
     "shell.execute_reply": "2020-10-13T16:59:46.986486Z"
    },
    "papermill": {
     "duration": 0.108842,
     "end_time": "2020-10-13T16:59:46.987157",
     "exception": false,
     "start_time": "2020-10-13T16:59:46.878315",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "((#37714) [0,1,2,3,4,5,6,7,8,9...],\n",
       " (#9301) [18990,18991,18992,18993,18994,18995,18996,18997,18998,18999...])"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "splits = IndexSplitter(val_idxs)(data.get_items())\n",
    "splits"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.039961,
     "end_time": "2020-10-13T16:59:47.067217",
     "exception": false,
     "start_time": "2020-10-13T16:59:47.027256",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "##  Creating a `Datasets` object"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:47.149404Z",
     "iopub.status.busy": "2020-10-13T16:59:47.148905Z",
     "iopub.status.idle": "2020-10-13T16:59:47.173664Z",
     "shell.execute_reply": "2020-10-13T16:59:47.174106Z"
    },
    "papermill": {
     "duration": 0.067561,
     "end_time": "2020-10-13T16:59:47.174243",
     "exception": false,
     "start_time": "2020-10-13T16:59:47.106682",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "tfms = [[ItemGetter(0), ToTensorTS(), ToTensorMotion()], # x transforms\n",
    "        [ItemGetter(1), lbl_dict.get, Categorize()]] # y transforms"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:47.258635Z",
     "iopub.status.busy": "2020-10-13T16:59:47.258107Z",
     "iopub.status.idle": "2020-10-13T16:59:51.913911Z",
     "shell.execute_reply": "2020-10-13T16:59:51.914354Z"
    },
    "papermill": {
     "duration": 4.698667,
     "end_time": "2020-10-13T16:59:51.914486",
     "exception": false,
     "start_time": "2020-10-13T16:59:47.215819",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 4.62 s, sys: 3.87 ms, total: 4.62 s\n",
      "Wall time: 4.63 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "ds = Datasets(items=data.get_items(), tfms=tfms, splits=splits)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.040188,
     "end_time": "2020-10-13T16:59:51.996566",
     "exception": false,
     "start_time": "2020-10-13T16:59:51.956378",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Show one element of the dataset. By default, the `show` method will display the item as a Poincare map."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:52.081257Z",
     "iopub.status.busy": "2020-10-13T16:59:52.080728Z",
     "iopub.status.idle": "2020-10-13T16:59:52.271263Z",
     "shell.execute_reply": "2020-10-13T16:59:52.271677Z"
    },
    "papermill": {
     "duration": 0.233602,
     "end_time": "2020-10-13T16:59:52.271814",
     "exception": false,
     "start_time": "2020-10-13T16:59:52.038212",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "rotational\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = show_at(ds, 1003, figsize=(1,1))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.040594,
     "end_time": "2020-10-13T16:59:52.355986",
     "exception": false,
     "start_time": "2020-10-13T16:59:52.315392",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "It can be useful to visualize the motions with he same y limits. We take them from the training set"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:52.445431Z",
     "iopub.status.busy": "2020-10-13T16:59:52.444919Z",
     "iopub.status.idle": "2020-10-13T16:59:52.493279Z",
     "shell.execute_reply": "2020-10-13T16:59:52.493694Z"
    },
    "papermill": {
     "duration": 0.096897,
     "end_time": "2020-10-13T16:59:52.493831",
     "exception": false,
     "start_time": "2020-10-13T16:59:52.396934",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[-0.621060974808266, 1.62106097480744]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ylim = [data.x[:, 1].min(), data.x[:, 1].max()]\n",
    "ylim"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:52.580867Z",
     "iopub.status.busy": "2020-10-13T16:59:52.580358Z",
     "iopub.status.idle": "2020-10-13T16:59:52.766782Z",
     "shell.execute_reply": "2020-10-13T16:59:52.766240Z"
    },
    "papermill": {
     "duration": 0.230605,
     "end_time": "2020-10-13T16:59:52.766898",
     "exception": false,
     "start_time": "2020-10-13T16:59:52.536293",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "rotational\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = show_at(ds, 1003, figsize=(1,1), ylim=ylim)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.042324,
     "end_time": "2020-10-13T16:59:52.852491",
     "exception": false,
     "start_time": "2020-10-13T16:59:52.810167",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Creating a `Dataloaders` object"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:52.939776Z",
     "iopub.status.busy": "2020-10-13T16:59:52.939250Z",
     "iopub.status.idle": "2020-10-13T16:59:55.662326Z",
     "shell.execute_reply": "2020-10-13T16:59:55.661786Z"
    },
    "papermill": {
     "duration": 2.768175,
     "end_time": "2020-10-13T16:59:55.662447",
     "exception": false,
     "start_time": "2020-10-13T16:59:52.894272",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "bs = 256                            \n",
    "# Normalize at batch time\n",
    "tfm_norm = Standardize(scale_subtype = 'per_sample')\n",
    "batch_tfms = []\n",
    "\n",
    "dls = ds.dataloaders(bs=bs, val_bs=bs * 2, after_batch=batch_tfms, num_workers=0, device=default_device()) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:55.750922Z",
     "iopub.status.busy": "2020-10-13T16:59:55.750351Z",
     "iopub.status.idle": "2020-10-13T16:59:57.074387Z",
     "shell.execute_reply": "2020-10-13T16:59:57.074856Z"
    },
    "papermill": {
     "duration": 1.369485,
     "end_time": "2020-10-13T16:59:57.074992",
     "exception": false,
     "start_time": "2020-10-13T16:59:55.705507",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1008x864 with 9 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "dls.show_batch(max_n=9, ylim=ylim, return_fig=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:57.165613Z",
     "iopub.status.busy": "2020-10-13T16:59:57.165104Z",
     "iopub.status.idle": "2020-10-13T16:59:57.386676Z",
     "shell.execute_reply": "2020-10-13T16:59:57.386216Z"
    },
    "papermill": {
     "duration": 0.267795,
     "end_time": "2020-10-13T16:59:57.386794",
     "exception": false,
     "start_time": "2020-10-13T16:59:57.118999",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "tensor([178.2151,  -0.4584], device='cuda:0') tensor([1.0056e+02, 4.2195e-02], device='cuda:0')\n"
     ]
    }
   ],
   "source": [
    "xb, yb = dls.one_batch()\n",
    "print(xb[0].mean(axis=1), xb[0].std(axis=1))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.043505,
     "end_time": "2020-10-13T16:59:57.475168",
     "exception": false,
     "start_time": "2020-10-13T16:59:57.431663",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Training a model "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:57.565664Z",
     "iopub.status.busy": "2020-10-13T16:59:57.565153Z",
     "iopub.status.idle": "2020-10-13T16:59:57.591811Z",
     "shell.execute_reply": "2020-10-13T16:59:57.592225Z"
    },
    "papermill": {
     "duration": 0.073249,
     "end_time": "2020-10-13T16:59:57.592365",
     "exception": false,
     "start_time": "2020-10-13T16:59:57.519116",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(2, 3)"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Number of channels\n",
    "c_in = get_n_channels(dls.train) # data.n_channels\n",
    "# Number of classes\n",
    "c_out= dls.c \n",
    "c_in,c_out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:57.684996Z",
     "iopub.status.busy": "2020-10-13T16:59:57.684467Z",
     "iopub.status.idle": "2020-10-13T16:59:57.722102Z",
     "shell.execute_reply": "2020-10-13T16:59:57.722568Z"
    },
    "papermill": {
     "duration": 0.08485,
     "end_time": "2020-10-13T16:59:57.722705",
     "exception": false,
     "start_time": "2020-10-13T16:59:57.637855",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "model = inception_time(c_in, c_out).to(device=default_device())\n",
    "# model"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": 0.043883,
     "end_time": "2020-10-13T16:59:57.810886",
     "exception": false,
     "start_time": "2020-10-13T16:59:57.767003",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Creating a Learner object"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:57.907323Z",
     "iopub.status.busy": "2020-10-13T16:59:57.906808Z",
     "iopub.status.idle": "2020-10-13T16:59:57.933372Z",
     "shell.execute_reply": "2020-10-13T16:59:57.932893Z"
    },
    "papermill": {
     "duration": 0.077865,
     "end_time": "2020-10-13T16:59:57.933492",
     "exception": false,
     "start_time": "2020-10-13T16:59:57.855627",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# opt_func = partial(Adam, lr=3e-3, wd=0.01)\n",
    "#Or use Ranger\n",
    "def opt_func(p, lr=slice(3e-3)): return Lookahead(RAdam(p, lr=lr, mom=0.95, wd=0.01)) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:58.026019Z",
     "iopub.status.busy": "2020-10-13T16:59:58.025523Z",
     "iopub.status.idle": "2020-10-13T16:59:58.054179Z",
     "shell.execute_reply": "2020-10-13T16:59:58.054635Z"
    },
    "papermill": {
     "duration": 0.076132,
     "end_time": "2020-10-13T16:59:58.054775",
     "exception": false,
     "start_time": "2020-10-13T16:59:57.978643",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#Learner    \n",
    "loss_func = LabelSmoothingCrossEntropy() \n",
    "learn = Learner(dls, model, opt_func=opt_func, \n",
    "                loss_func=loss_func, metrics=accuracy)\n",
    "\n",
    "# print(learn.summary())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T16:59:58.147289Z",
     "iopub.status.busy": "2020-10-13T16:59:58.146790Z",
     "iopub.status.idle": "2020-10-13T17:00:19.994707Z",
     "shell.execute_reply": "2020-10-13T17:00:19.995149Z"
    },
    "papermill": {
     "duration": 21.895197,
     "end_time": "2020-10-13T17:00:19.995285",
     "exception": false,
     "start_time": "2020-10-13T16:59:58.100088",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "(0.03630780577659607, 0.0004786300996784121)"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "lr_min, lr_steep = learn.lr_find()\n",
    "lr_min, lr_steep"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-13T17:00:20.094749Z",
     "iopub.status.busy": "2020-10-13T17:00:20.094206Z"
    },
    "papermill": {
     "duration": 132.196684,
     "end_time": "2020-10-13T17:02:32.242118",
     "exception": false,
     "start_time": "2020-10-13T17:00:20.045434",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "WandbCallback requires use of \"SaveModelCallback\" to log best model\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "\n",
       "    <div>\n",
       "        <style>\n",
       "            /* Turns off some styling */\n",
       "            progress {\n",
       "                /* gets rid of default border in Firefox and Opera. */\n",
       "                border: none;\n",
       "                /* Needs to be in here for Safari polyfill so background images work as expected. */\n",
       "                background-size: auto;\n",
       "            }\n",
       "            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n",
       "                background: #F44336;\n",
       "            }\n",
       "        </style>\n",
       "      <progress value='3' class='' max='10' style='width:300px; height:20px; vertical-align: middle;'></progress>\n",
       "      30.00% [3/10 01:45<04:05]\n",
       "    </div>\n",
       "    \n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: left;\">\n",
       "      <th>epoch</th>\n",
       "      <th>train_loss</th>\n",
       "      <th>valid_loss</th>\n",
       "      <th>accuracy</th>\n",
       "      <th>time</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0.639177</td>\n",
       "      <td>0.483269</td>\n",
       "      <td>0.894205</td>\n",
       "      <td>00:35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>0.461417</td>\n",
       "      <td>0.422545</td>\n",
       "      <td>0.928395</td>\n",
       "      <td>00:34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0.416308</td>\n",
       "      <td>0.420230</td>\n",
       "      <td>0.930868</td>\n",
       "      <td>00:35</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table><p>\n",
       "\n",
       "    <div>\n",
       "        <style>\n",
       "            /* Turns off some styling */\n",
       "            progress {\n",
       "                /* gets rid of default border in Firefox and Opera. */\n",
       "                border: none;\n",
       "                /* Needs to be in here for Safari polyfill so background images work as expected. */\n",
       "                background-size: auto;\n",
       "            }\n",
       "            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {\n",
       "                background: #F44336;\n",
       "            }\n",
       "        </style>\n",
       "      <progress value='139' class='' max='147' style='width:300px; height:20px; vertical-align: middle;'></progress>\n",
       "      94.56% [139/147 00:27<00:01 0.3924]\n",
       "    </div>\n",
       "    "
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "learn.fit_one_cycle(10, lr_max=1e-3, cbs=WandbCallback(log_preds=False))\n",
    "learn.recorder.plot_loss()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Showing results"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Results for random items in the validation set "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "learn.show_results(max_n=9, ylim=ylim)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Confusion matrix"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "interp = ClassificationInterpretationAugmented.from_learner(learn)\n",
    "interp.plot_confusion_matrix()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Smallest errors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "interp.plot_top_losses(k=9, figsize=(15, 15), largest=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Largest errores"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "interp.plot_top_losses(k=15, figsize=(15, 15), nrows=5, largest=True, ylim=ylim)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Specific types of errors"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "It is also interesting to display separately errors of different type. There are a number of `c*(c-1)` possible type of errors, where `c` is the number of classes in the data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "print(interp.top_losses(k=3, largest=False, predicted='chaotic', actual='chaotic'))\n",
    "print(interp.top_losses(k=3, largest=False, predicted='rotational', actual='rotational'))\n",
    "print(interp.top_losses(k=3, largest=False, predicted='librational', actual='librational'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "predicted = 'chaotic'\n",
    "actual = 'chaotic'\n",
    "n_errors = interp.confusion_matrix()[interp.vocab.o2i[predicted], \n",
    "                                     interp.vocab.o2i[actual]]\n",
    "interp.plot_top_losses(k=min(n_errors, 9), figsize=(15, 15), \n",
    "                       largest=True, ylim=ylim, \n",
    "                       predicted=predicted, \n",
    "                       actual=actual)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Overview of the results through a labelled initial condition map"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Show each motion in the validation set in a Poincare map showing just its initial point (x0, y0), coloured by the dynamical index associated to it. We will plot two figures, one with the dynamical index given by the ML model (predictions) and one with the true dynamic indices given by the `labelling_method`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "ml_map = show_labelled_ic_map(interp.inputs[0], \n",
    "                    [dls.tfms[1].decode(y) for y in interp.decoded], \n",
    "                    legend=None,\n",
    "                    palette=dict(\n",
    "                        chaotic='yellow', \n",
    "                        librational='blue', \n",
    "                        rotational='magenta'))\n",
    "\n",
    "wandb.log({f'ML map ({val_dataset})': ml_map.figure})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "true_map = show_labelled_ic_map(interp.inputs[0], \n",
    "                    [dls.tfms[1].decode(y) for y in interp.targs], \n",
    "                    legend=None,\n",
    "                    palette=dict(\n",
    "                        chaotic='yellow', \n",
    "                        librational='blue', \n",
    "                        rotational='magenta'))\n",
    "\n",
    "wandb.log({f'True map ({val_dataset})': ml_map.figure})"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Explaining the model predictions through class activation maps (TODO)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "We will use the function `show_cam` from the library `timeseries` to plot the Class Activation Maps (CAMs)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "?show_cam"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "We need a function `i2o` that, given an encoded y, i.e, an instance of `TensorCategory`, return the label associated to that index, i.e., we need to decode the labels."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def i2o(y):\n",
    "    return dls.tfms[1].decode(y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "print(i2o(TensorCategory(0)))\n",
    "print(i2o(TensorCategory(1)))\n",
    "print(i2o(TensorCategory(2)))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## Inference on a new test set"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Now let's see how the trained behaves with a completely unseen set of data. First we have to load the Poincare maps that comprise the test set"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Compute the predicted labels using the library `fastinference`. It is faster than the original `fastai` implementation."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "#old_get_preds = learn.get_preds\n",
    "#from fastinference.inference import *"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "test_base_path = base_path/'data/eps=0.02_pert_pend_model_2'"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "fnames_test = (test_base_path/'Poincare200pt.plt', \n",
    "               test_base_path/'index200pt.plt')\n",
    "test_data = TSDataChaos.from_poincare_and_index_files(fnames_test)\n",
    "test_data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "if not wandb.config.add_uncertainty_class:\n",
    "    test_data.x = test_data.x[test_data.y != -1]\n",
    "    test_data.y = test_data.y[test_data.y != -1]\n",
    "test_data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Create a dataloader from the test items previously loaded. This will apply all the transformations used in our training and validation set (e.g. normalization) to the test data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "test_dl = learn.dls.test_dl(test_data.get_items(), with_labels=True)\n",
    "test_dl.n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "preds, targs, preds_decoded = learn.get_preds(dl=test_dl, with_decoded=True)\n",
    "preds.__len__()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Compute metrics (validation loss and accuracy) on the test set."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "test_metrics = learn.validate(dl=test_dl)\n",
    "test_metrics"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Show also trhe confusion matrix for this test set"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# learn.get_preds = old_get_preds\n",
    "interp_test = ClassificationInterpretationAugmented.from_learner(learn, \n",
    "                                                                 dl=test_dl)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "interp_test.plot_confusion_matrix(\n",
    "    title=f'Confusion matrix (accuracy={round(test_metrics[1], 2)})',\n",
    ")\n",
    "plt.savefig(test_base_path/f'confusion_matrix_{test_base_path.name}.png')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Show the FLI plot to get a sense of the quality of the predictions"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "ml_map = show_fli_plot(test_data.x, \n",
    "                    [dls.tfms[1].decode(y) for y in preds_decoded], \n",
    "                    legend=None,\n",
    "                    palette=dict(\n",
    "                        chaotic='yellow', \n",
    "                        librational='blue', \n",
    "                        rotational='magenta'))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "ml_map.figure.savefig(test_base_path/f'ml_map_{test_base_path.name}.eps', \n",
    "                      transparent=True, format='.eps')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "Now show the same plot for the true labels given by the FLI-based classification"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "true_map = show_fli_plot(test_data.x, \n",
    "                    [dls.tfms[1].decode(y) for y in targs], \n",
    "                    legend=None,\n",
    "                    palette=dict(\n",
    "                        chaotic='yellow', \n",
    "                        librational='blue', \n",
    "                        rotational='magenta'))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "papermill": {
     "duration": null,
     "end_time": null,
     "exception": null,
     "start_time": null,
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "true_map.figure.savefig(test_base_path/f'true_map_{test_base_path.name}.eps', \n",
    "                        transparent=True, format='.eps')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.9"
  },
  "papermill": {
   "duration": 183.06824,
   "end_time": "2020-10-13T17:02:32.952107",
   "environment_variables": {},
   "exception": null,
   "input_path": "nbs/_motion_classification_time_series.ipynb",
   "output_path": "--",
   "parameters": {
    "labelling_method": "fli",
    "use_wandb": true,
    "wandb_group": "x_labelling_method"
   },
   "start_time": "2020-10-13T16:59:29.883867",
   "version": "2.1.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}